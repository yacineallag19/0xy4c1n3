<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Blitz CTF 2025 writeups (Cryptography) | Yacine&#39;s blog</title>
<meta name="keywords" content="CTF, Cryptography, writeups, Cyber Security, Blitz CTF">
<meta name="description" content="

Introduction
I will be covering here writeups to challenges I was able to solve in the BlitzCTF 2025:

Custom RSA ( cryptography )
Custom RSA Revenge ( cryptography )
Fiboz ( cryptography )
maffs ( cryptography )


Custom RSA
We were given 2 files:

Custom_RSA.py
out_4.txt

Initial Analysis
Let&rsquo;s start by reading the source code and understanding what each part does:
p = getPrime(256)  
q = getPrime(256)  
x = getPrime(128)  
y = getPrime(128)  
z = getPrime(128)
This generates 5 primes: p, q, x, y and z. The information we can keep in mind is the fact that x, y and z are 128 bits which makes the product of each 2 of them easy to factor.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/blitz-ctf-writeups-cryptography/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/blitz-ctf-writeups-cryptography/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Yacine&#39;s blog (Alt + H)">Yacine&#39;s blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Blitz CTF 2025 writeups (Cryptography)
    </h1>
    <div class="post-meta"><span title='2025-07-25 09:52:05 +0100 CET'>July 25, 2025</span>&nbsp;·&nbsp;10 min

</div>
  </header> 
  <div class="post-content"><hr>
<p><img alt="Challenge Image" loading="lazy" src="https://ctftime.org/media/cache/7b/b5/7bb5df82fc9891185faf9588ea436b91.png"></p>
<h3 id="introduction"><strong>Introduction</strong><a hidden class="anchor" aria-hidden="true" href="#introduction">#</a></h3>
<p>I will be covering here writeups to challenges I was able to solve in the BlitzCTF 2025:</p>
<ul>
<li>Custom RSA ( cryptography )</li>
<li>Custom RSA Revenge ( cryptography )</li>
<li>Fiboz ( cryptography )</li>
<li>maffs ( cryptography )</li>
</ul>
<hr>
<h3 id="custom-rsa"><strong>Custom RSA</strong><a hidden class="anchor" aria-hidden="true" href="#custom-rsa">#</a></h3>
<p>We were given 2 files:</p>
<ul>
<li><a href="https://drive.google.com/file/d/18sDZ_AOuBk6FMQotDdLhfFNOpApBxXvs/view?usp=drive_link">Custom_RSA.py</a></li>
<li><a href="https://drive.google.com/file/d/1yxNTX9WgDRYZx99nn-TURhMn06fXXmz_/view?usp=drive_link">out_4.txt</a></li>
</ul>
<h4 id="initial-analysis">Initial Analysis<a hidden class="anchor" aria-hidden="true" href="#initial-analysis">#</a></h4>
<p>Let&rsquo;s start by reading the source code and understanding what each part does:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">256</span>)  
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">256</span>)  
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">128</span>)  
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">128</span>)  
</span></span><span style="display:flex;"><span>z <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">128</span>)
</span></span></code></pre></div><p>This generates 5 primes: <code>p</code>, <code>q</code>, <code>x</code>, <code>y</code> and <code>z</code>. The information we can keep in mind is the fact that <code>x</code>, <code>y</code> and <code>z</code> are 128 bits which makes the product of each 2 of them easy to factor.</p>
<p>Then we have:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>e <span style="color:#f92672">=</span> x<span style="color:#f92672">*</span>y<span style="color:#f92672">*</span>z
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> p<span style="color:#f92672">*</span>q<span style="color:#f92672">*</span>y
</span></span><span style="display:flex;"><span>hint1 <span style="color:#f92672">=</span> p <span style="color:#f92672">%</span> x
</span></span><span style="display:flex;"><span>hint2 <span style="color:#f92672">=</span> p <span style="color:#f92672">%</span> z
</span></span></code></pre></div><p>This sets the <code>exponent</code> to the product of <code>x</code>, <code>y</code> and <code>z</code>, as well as the <code>modulus</code> to the product of <code>p</code>, <code>q</code> and <code>y</code>. We notice that <code>y</code> is a common factor, and since both <code>e</code> and <code>n</code> are products to <strong>prime facotrs</strong>, we can conclude that: <code>y = GCD(n,e)</code>.
Last, 2 hint values are computed: <code>hint1 = p % x</code> and <code>hint2 = p % z</code>.
Finally, the flag is encrypted, and we are given the values of <code>e</code>, <code>n</code>, <code>hint1</code>, <code>hint2</code> and <code>c</code>.</p>
<h4 id="exploit-steps">Exploit Steps<a hidden class="anchor" aria-hidden="true" href="#exploit-steps">#</a></h4>
<ol>
<li>Recover <code>y</code> by computing: <code>y = GCD(n,e)</code>.</li>
<li>Calculate <code>x*z = e // y</code> then factor the value in order to get x and z (You can factor using a script or using factordb).</li>
<li>Recover <code>temp = p mod (x*z)</code>from <code>hint1</code> and <code>hint2</code> using CRT, then brute force all values <code>p = k * (x * z) + temp</code> till a value is a factor of <code>n</code>.</li>
<li>Recover <code>q</code>, calculate <code>d</code> and decrypt the flag.</li>
</ol>
<h4 id="python-solver">Python Solver<a hidden class="anchor" aria-hidden="true" href="#python-solver">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sympy <span style="color:#f92672">import</span> gcd
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> long_to_bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>hint1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">154888122383146971967744398191123189212</span>
</span></span><span style="display:flex;"><span>hint2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">130654136341446094800376989317102537325</span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">1291778230841963634710522186531131140292748304311790700929719174642140386189828346122801056721461179519840234314280632436994655344881023892312594913853574461748121277453328656446109784054563731</span>
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> <span style="color:#ae81ff">9397905637403387422411461938505089525132522490010480161341814566119369497062528168320590767152928258571447916140517</span>
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> <span style="color:#ae81ff">482782367816881259357312883356702175242817718119063880833819462767226937212873552015335218158868462980872863563953024168114906381978834311555560455076311389674805493391941801398577027462103318</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Step 1: calculate y</span>
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> int(gcd(n, e))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Step 2: get x and z by factoring x*z</span>
</span></span><span style="display:flex;"><span>xz <span style="color:#f92672">=</span> e <span style="color:#f92672">//</span> y
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> <span style="color:#ae81ff">205985756524450894105569840071389752521</span>
</span></span><span style="display:flex;"><span>z <span style="color:#f92672">=</span> <span style="color:#ae81ff">212007435030018912792096086712981924541</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Step 3: finding p mod x*z using CRT</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">chinese_remainder</span>(h, m1, h2, m2):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">inv</span>(a, m):
</span></span><span style="display:flex;"><span>        m0, x0, x1 <span style="color:#f92672">=</span> m, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> a <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            q <span style="color:#f92672">=</span> a <span style="color:#f92672">//</span> m
</span></span><span style="display:flex;"><span>            a, m <span style="color:#f92672">=</span> m, a <span style="color:#f92672">%</span> m
</span></span><span style="display:flex;"><span>            x0, x1 <span style="color:#f92672">=</span> x1 <span style="color:#f92672">-</span> q <span style="color:#f92672">*</span> x0, x0
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> x1 <span style="color:#f92672">%</span> m0
</span></span><span style="display:flex;"><span>    M <span style="color:#f92672">=</span> m1 <span style="color:#f92672">*</span> m2
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (h <span style="color:#f92672">*</span> m2 <span style="color:#f92672">*</span> inv(m2, m1) <span style="color:#f92672">+</span> h2 <span style="color:#f92672">*</span> m1 <span style="color:#f92672">*</span> inv(m1, m2)) <span style="color:#f92672">%</span> M, M
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p0, M <span style="color:#f92672">=</span> chinese_remainder(hint1, x, hint2, z)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Step 4: brute forcing till we get the correct p values</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>):
</span></span><span style="display:flex;"><span>    p <span style="color:#f92672">=</span> p0 <span style="color:#f92672">+</span> k <span style="color:#f92672">*</span> M
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> n <span style="color:#f92672">%</span> p <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 5: Calculating q</span>
</span></span><span style="display:flex;"><span>    q <span style="color:#f92672">=</span> n <span style="color:#f92672">//</span> ( p <span style="color:#f92672">*</span> y )
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 6: compute private exponent d and decrypt</span>
</span></span><span style="display:flex;"><span>    phi <span style="color:#f92672">=</span> int((p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (y<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        d <span style="color:#f92672">=</span> pow(e, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, phi)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">ValueError</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>    m <span style="color:#f92672">=</span> pow(c, d, n)
</span></span><span style="display:flex;"><span>    pt <span style="color:#f92672">=</span> long_to_bytes(m)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> pt<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Blitz&#34;</span>):
</span></span><span style="display:flex;"><span>        print(pt)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;no candidate found&#34;</span>)
</span></span></code></pre></div><p>There goes the flag: <strong>Blitz{H0w_D4r3_y0u_br34k_My_RSA_Ag41n!!!}</strong></p>
<hr>
<h3 id="custom-rsa-revenge"><strong>Custom RSA Revenge</strong><a hidden class="anchor" aria-hidden="true" href="#custom-rsa-revenge">#</a></h3>
<p>We were given 2 files:</p>
<ul>
<li><a href="https://drive.google.com/file/d/1mvOOqhcPuSNTIAlK-OoUR_PPynuBuf_W/view?usp=drive_link">crypto1.py</a></li>
<li><a href="https://drive.google.com/file/d/1SbOepVzlhRdjocS0p5YC2subxysT6Zh2/view?usp=drive_link">crypto1_out.txt</a></li>
</ul>
<h4 id="initial-analysis-1">Initial Analysis<a hidden class="anchor" aria-hidden="true" href="#initial-analysis-1">#</a></h4>
<p>Let&rsquo;s start by reading the source code and understanding what each part does:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">150</span>)
</span></span><span style="display:flex;"><span>q <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">150</span>)
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> p<span style="color:#f92672">*</span>q
</span></span></code></pre></div><p>So far seems like a usual RSA setup, let&rsquo;s continue:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mod_phi <span style="color:#f92672">=</span> (p<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(q<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)<span style="color:#f92672">*</span>(e<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>d <span style="color:#f92672">=</span> pow(e, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, mod_phi)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>print(mod_phi)
</span></span><span style="display:flex;"><span>print(n)
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> pow(bytes_to_long(m), e, n)
</span></span><span style="display:flex;"><span>print(c)
</span></span></code></pre></div><p>Now we can spot the issue, <code>mod_phi</code> is easy to factor in no time, if we manage to factor it we can easily recover <code>e</code>, <code>p</code> and <code>q</code>.</p>
<p>I used this tool: <a href="https://www.alpertron.com.ar/ECM.HTM">Factorization online tool</a>.
It gave many factors but we will use this so we don&rsquo;t have to keep copying pasting:
<code>381 679521 901481 226602 014060 495892 168161 810654 344421 566396 411258 375972 593287 031851 626446 898065 545609 421743 932153 327689 119440 405912 (129 digits) = 23 × 32 × 67 × 673 × 3181 × 252401 × 23 896409 × 145 028189 × 79 561224 974873 × 308 026511 504069 × 4509 599821 882817 × 9907 158782 085681 344183 × 38 588687 064594 940957 905160 665643 (32 digits)</code>.
Using these prime factors, we will generate all possible factors, and for each factor <code>f</code> we will check if <code>f+1</code> divides <code>n</code>, then we would have the values of <code>p</code>,<code>q</code> and <code>e</code>, and we can just decrypt then.</p>
<h4 id="python-solver-1">Python Solver<a hidden class="anchor" aria-hidden="true" href="#python-solver-1">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> sympy <span style="color:#f92672">import</span> Integer
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> itertools <span style="color:#f92672">import</span> product
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> long_to_bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Factorization result of mod_phi</span>
</span></span><span style="display:flex;"><span>factors <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">2</span>: <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">3</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">23</span>: <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">32</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">67</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">673</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">3181</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">252401</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">23896409</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">145028189</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">79561224974873</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">308026511504069</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">4509599821882817</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">9907158782085681344183</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">38588687064594940957905160665643</span>: <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Generate all divisors of mod_phi</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_divisors</span>(factors):
</span></span><span style="display:flex;"><span>    primes <span style="color:#f92672">=</span> list(factors<span style="color:#f92672">.</span>items())
</span></span><span style="display:flex;"><span>    exponents <span style="color:#f92672">=</span> [range(e <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">for</span> _, e <span style="color:#f92672">in</span> primes]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> powers <span style="color:#f92672">in</span> product(<span style="color:#f92672">*</span>exponents):
</span></span><span style="display:flex;"><span>        divisor <span style="color:#f92672">=</span> Integer(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (base, _), power <span style="color:#f92672">in</span> zip(primes, powers):
</span></span><span style="display:flex;"><span>            divisor <span style="color:#f92672">*=</span> base <span style="color:#f92672">**</span> power
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield</span> divisor
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n <span style="color:#f92672">=</span> <span style="color:#ae81ff">1236102848705753437579242450812782858653671889829265508760569425093229541662967763302228061</span>
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> <span style="color:#ae81ff">337624956533508120294617117960499986227311117648449203609049153277315646351029821010820258</span>
</span></span><span style="display:flex;"><span>mod_phi <span style="color:#f92672">=</span> <span style="color:#ae81ff">381679521901481226602014060495892168161810654344421566396411258375972593287031851626446898065545609421743932153327689119440405912</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Step 1: generate all divisors of mod_phi</span>
</span></span><span style="display:flex;"><span>divisors <span style="color:#f92672">=</span> sorted(get_divisors(factors))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;[*] Total divisors: </span><span style="color:#e6db74">{</span>len(divisors)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Step 2: check if (d+1) divides n (this reveals p or q)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> d <span style="color:#f92672">in</span> divisors:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> n <span style="color:#f92672">%</span> (d <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        p <span style="color:#f92672">=</span> d <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        q <span style="color:#f92672">=</span> n <span style="color:#f92672">//</span> p
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;[+] Found factors! p = </span><span style="color:#e6db74">{</span>p<span style="color:#e6db74">}</span><span style="color:#e6db74">, q = </span><span style="color:#e6db74">{</span>q<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Step 3: recover e</span>
</span></span><span style="display:flex;"><span>        phi <span style="color:#f92672">=</span> (p <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (q <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        e <span style="color:#f92672">=</span> mod_phi <span style="color:#f92672">//</span> phi <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;[+] Recovered e = </span><span style="color:#e6db74">{</span>e<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Step 4: compute private exponent d and decrypt</span>
</span></span><span style="display:flex;"><span>        d_priv <span style="color:#f92672">=</span> pow(e, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, phi)
</span></span><span style="display:flex;"><span>        m <span style="color:#f92672">=</span> pow(c, d_priv, n)
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;[+] Decrypted flag:&#34;</span>, long_to_bytes(m))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span></code></pre></div><p>There goes the flag: <strong>Blitz{Cust0m_RSA_OMGGG}</strong></p>
<hr>
<h3 id="fiboz"><strong>Fiboz</strong><a hidden class="anchor" aria-hidden="true" href="#fiboz">#</a></h3>
<p>We were given 2 files:</p>
<ul>
<li><a href="https://drive.google.com/file/d/1kZUISefyYOQoVUKQUX-BWH_R00-B4T2J/view?usp=drive_link">Fiboz.py</a></li>
<li><a href="https://drive.google.com/file/d/11Fhf4bi6Z6cMdD4Yj_jAmvv7s3pSirD8/view?usp=drive_link">output.enc</a></li>
</ul>
<h4 id="initial-analysis-2">Initial Analysis<a hidden class="anchor" aria-hidden="true" href="#initial-analysis-2">#</a></h4>
<p>Let&rsquo;s start by reading the source code and understanding what each part does:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">x7a3</span>(n):
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> n <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        n <span style="color:#f92672">=</span> n <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span> <span style="color:#66d9ef">if</span> n <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        s <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> s
</span></span></code></pre></div><p>This function implements the Collatz sequence, which is a mathematical process that repeatedly transforms a number until it becomes 1, and it returns how many steps the process took.
Then we have:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">y4f2</span>(l, a<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, b<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> [a, b]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(l <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>        r<span style="color:#f92672">.</span>append(r[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> r[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> r
</span></span></code></pre></div><p>This function generates a Fibonacci-like sequence, which is a list of numbers where each new number is the sum of the previous two, and it returns the sequence of length <code>l</code> starting with <code>a</code> and <code>b</code>.
Finally, the last function is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">z9k1</span>(s, k):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> bytes(ord(c) <span style="color:#f92672">^</span> (k[i <span style="color:#f92672">%</span> len(k)] <span style="color:#f92672">%</span> <span style="color:#ae81ff">256</span>) <span style="color:#66d9ef">for</span> i, c <span style="color:#f92672">in</span> enumerate(s))
</span></span></code></pre></div><p>This function takes a string <code>s</code> and a key <code>k</code>, and returns a <code>bytes</code> object where each character in <code>s</code> is XORed with the corresponding (cyclic) element of <code>k</code> modulo 256.</p>
<p>Now it is time to check what the main function is doing:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Challenge ready!&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        l <span style="color:#f92672">=</span> int(input(<span style="color:#e6db74">&#34;Enter length: &#34;</span>))
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> int(input(<span style="color:#e6db74">&#34;First seed [1]: &#34;</span>) <span style="color:#f92672">or</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> int(input(<span style="color:#e6db74">&#34;Second seed [1]: &#34;</span>) <span style="color:#f92672">or</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Error&#34;</span>)
</span></span><span style="display:flex;"><span>        sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    f <span style="color:#f92672">=</span> y4f2(l, a, b)
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> [x7a3(n) <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> f]
</span></span><span style="display:flex;"><span>    t <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">Input text: &#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">not</span> t:
</span></span><span style="display:flex;"><span>        t <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Blitz</span><span style="color:#e6db74">{example_flag}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    e <span style="color:#f92672">=</span> z9k1(t, c)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;output.enc&#39;</span>, <span style="color:#e6db74">&#39;wb&#39;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>        file<span style="color:#f92672">.</span>write(e)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Output written to output.enc (hex format)&#34;</span>)
</span></span></code></pre></div><p>The <code>main()</code> function first takes user input for <code>l</code>, <code>a</code>, and <code>b</code>, and passes them to <code>y4f2()</code> to generate a list of numbers, storing the result in <code>f</code>.<br>
Then it applies <code>x7a3()</code> to each element of <code>f</code>, storing the transformed list in <code>c</code>.<br>
Finally, it takes the flag, encrypts it with <code>z9k1(t, c)</code> and saves the result as <code>output.enc</code>.</p>
<h4 id="identifying-the-vulnerability">Identifying The Vulnerability<a hidden class="anchor" aria-hidden="true" href="#identifying-the-vulnerability">#</a></h4>
<p>The vulnerability here is that the flag format (Blitz{&hellip;}) is known, the first key bytes can be recovered, making it easy to brute force the <code>a</code> and <code>b</code> values and decrypt the message.</p>
<h4 id="exploitation-steps">Exploitation Steps<a hidden class="anchor" aria-hidden="true" href="#exploitation-steps">#</a></h4>
<ol>
<li>Use the known prefix <code>Blitz{</code> to recover the first key bytes by XORing with the ciphertext.</li>
<li>Precompute Collatz step counts and map step values back to possible numbers.</li>
<li>From the first key bytes, get candidate values for <code>a</code> and <code>b</code>.</li>
<li>Check which <code>(a,b)</code> pairs fit the Fibonacci-like pattern with the next key bytes.</li>
<li>For valid <code>(a,b)</code>, rebuild the full key, decrypt the ciphertext, and check the result.</li>
<li>If the text starts with <code>Blitz{</code>, that’s the flag.</li>
</ol>
<h4 id="python-solver-2">Python Solver<a hidden class="anchor" aria-hidden="true" href="#python-solver-2">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> defaultdict
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">x7a3</span>(n):
</span></span><span style="display:flex;"><span>    steps <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> n <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        n <span style="color:#f92672">=</span> n <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span> <span style="color:#66d9ef">if</span> n <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        steps <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> steps
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">precompute_x7a3</span>(max_n):
</span></span><span style="display:flex;"><span>    table <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> (max_n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">2</span>, max_n <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        x, steps <span style="color:#f92672">=</span> n, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> x <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            x <span style="color:#f92672">=</span> x <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span> <span style="color:#66d9ef">if</span> x <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> x <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            steps <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> x <span style="color:#f92672">&gt;</span> max_n:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        table[n] <span style="color:#f92672">=</span> steps
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> table
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">build_k_to_n</span>(x7a3_table):
</span></span><span style="display:flex;"><span>    k_to_n <span style="color:#f92672">=</span> defaultdict(list)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> n, k <span style="color:#f92672">in</span> enumerate(x7a3_table):
</span></span><span style="display:flex;"><span>        k_to_n[k]<span style="color:#f92672">.</span>append(n)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> k_to_n
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">y4f2</span>(length, a, b):
</span></span><span style="display:flex;"><span>    seq <span style="color:#f92672">=</span> [a, b]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(length <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>):
</span></span><span style="display:flex;"><span>        seq<span style="color:#f92672">.</span>append(seq[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> seq[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> seq
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>(ciphertext, key):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> bytes([ciphertext[i] <span style="color:#f92672">^</span> (key[i <span style="color:#f92672">%</span> len(key)] <span style="color:#f92672">%</span> <span style="color:#ae81ff">256</span>) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(ciphertext))])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">recover_a_b</span>(ciphertext, plaintext_start, max_n<span style="color:#f92672">=</span><span style="color:#ae81ff">10000000</span>):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 1</span>
</span></span><span style="display:flex;"><span>    k <span style="color:#f92672">=</span> [plaintext_start[i] <span style="color:#f92672">^</span> ciphertext[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(plaintext_start))]
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;Recovered key bytes: </span><span style="color:#e6db74">{</span>k<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 2</span>
</span></span><span style="display:flex;"><span>    x7a3_table <span style="color:#f92672">=</span> precompute_x7a3(max_n)
</span></span><span style="display:flex;"><span>    k_to_n <span style="color:#f92672">=</span> build_k_to_n(x7a3_table)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># Step 3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> k_to_n<span style="color:#f92672">.</span>get(k[<span style="color:#ae81ff">0</span>], []):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> b <span style="color:#f92672">in</span> k_to_n<span style="color:#f92672">.</span>get(k[<span style="color:#ae81ff">1</span>], []):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Step 4</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (a <span style="color:#f92672">+</span> b) <span style="color:#f92672">&gt;</span> max_n <span style="color:#f92672">or</span> x7a3_table[a <span style="color:#f92672">+</span> b] <span style="color:#f92672">!=</span> k[<span style="color:#ae81ff">2</span>]:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (a <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> b) <span style="color:#f92672">&gt;</span> max_n <span style="color:#f92672">or</span> x7a3_table[a <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> b] <span style="color:#f92672">!=</span> k[<span style="color:#ae81ff">3</span>]:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> a <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> b) <span style="color:#f92672">&gt;</span> max_n <span style="color:#f92672">or</span> x7a3_table[<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> a <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> b] <span style="color:#f92672">!=</span> k[<span style="color:#ae81ff">4</span>]:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> a <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> b) <span style="color:#f92672">&gt;</span> max_n <span style="color:#f92672">or</span> x7a3_table[<span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> a <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> b] <span style="color:#f92672">!=</span> k[<span style="color:#ae81ff">5</span>]:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Step 5</span>
</span></span><span style="display:flex;"><span>            f <span style="color:#f92672">=</span> y4f2(len(ciphertext), a, b)
</span></span><span style="display:flex;"><span>            c <span style="color:#f92672">=</span> [x7a3(n) <span style="color:#66d9ef">for</span> n <span style="color:#f92672">in</span> f]
</span></span><span style="display:flex;"><span>            decrypted <span style="color:#f92672">=</span> decrypt(ciphertext, c)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>                decrypted_text <span style="color:#f92672">=</span> decrypted<span style="color:#f92672">.</span>decode(<span style="color:#e6db74">&#39;ascii&#39;</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># Step 6</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> decrypted_text<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#34;Blitz{&#34;</span>):
</span></span><span style="display:flex;"><span>                    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;a=</span><span style="color:#e6db74">{</span>a<span style="color:#e6db74">}</span><span style="color:#e6db74">, b=</span><span style="color:#e6db74">{</span>b<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>                    print(decrypted_text)
</span></span><span style="display:flex;"><span>                    sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">UnicodeDecodeError</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#39;output.enc&#39;</span>, <span style="color:#e6db74">&#39;rb&#39;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>        ciphertext <span style="color:#f92672">=</span> f<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    plaintext_start <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;Blitz{&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(ciphertext) <span style="color:#f92672">&lt;</span> len(plaintext_start):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;Ciphertext too short!&#34;</span>)
</span></span><span style="display:flex;"><span>        sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    recover_a_b(ciphertext, plaintext_start)
</span></span></code></pre></div><p>The output:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Recovered key bytes: <span style="color:#f92672">[</span>180, 129, 246, 102, 131, 186<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">=</span>121393, b<span style="color:#f92672">=</span><span style="color:#ae81ff">196418</span>
</span></span><span style="display:flex;"><span>Blitz<span style="color:#f92672">{</span>So_You_Have_Studied_Fibonacci_And_Collatz_Conjecture_Now?<span style="color:#f92672">}</span>
</span></span></code></pre></div><p>There goes the flag: <strong>Blitz{So_You_Have_Studied_Fibonacci_And_Collatz_Conjecture_Now?}</strong></p>
<hr>
<h3 id="muffs"><strong>Muffs</strong><a hidden class="anchor" aria-hidden="true" href="#muffs">#</a></h3>
<p>We were given 34 files:</p>
<ul>
<li><a href="https://drive.google.com/drive/folders/1mRSxuarJHQ_aouUPjQUj7ltfOPYIwVuB?usp=drive_link">Files link</a></li>
</ul>
<p>Each file contained a set of points <code>(x,y)</code>that were sampled from an unknown polynomial. The idea was that the coefficients of this polynomial were everything we needed. By fitting a polynomial to the points in each file, we could recover its coefficients, and from there compute its derivatives at <code>x=0</code>. Since the <code>i-th</code> derivative at zero is simply <code>a⋅i!</code>, where <code>a</code>​ is the <code>i-th</code>coefficient, one of these derivatives in each file turned out to be very close to an integer within the printable ASCII range. That integer represented a character of the flag. By repeating this process for all 34 files, we extracted one character from each and combined them to reconstruct the entire flag.</p>
<h4 id="python-solver-3">Python Solver<a hidden class="anchor" aria-hidden="true" href="#python-solver-3">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> numpy <span style="color:#66d9ef">as</span> np
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> glob
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> math <span style="color:#f92672">import</span> factorial
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">is_printable_ascii</span>(c):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">32</span> <span style="color:#f92672">&lt;=</span> c <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">126</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decode_flag</span>():
</span></span><span style="display:flex;"><span>    files <span style="color:#f92672">=</span> sorted(glob<span style="color:#f92672">.</span>glob(<span style="color:#e6db74">&#34;f*.txt&#34;</span>), key<span style="color:#f92672">=</span><span style="color:#66d9ef">lambda</span> fn: int(fn[<span style="color:#ae81ff">1</span>:<span style="color:#f92672">-</span><span style="color:#ae81ff">4</span>]))
</span></span><span style="display:flex;"><span>    chars <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> fn <span style="color:#f92672">in</span> files:
</span></span><span style="display:flex;"><span>        data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>loadtxt(fn)
</span></span><span style="display:flex;"><span>        x, y <span style="color:#f92672">=</span> data[:, <span style="color:#ae81ff">0</span>], data[:, <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        X <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>column_stack([x<span style="color:#f92672">**</span>i <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">9</span>)])
</span></span><span style="display:flex;"><span>        coeffs, <span style="color:#f92672">*</span>_ <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>lstsq(X, y, rcond<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        best_char <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;?&#39;</span>
</span></span><span style="display:flex;"><span>        best_error <span style="color:#f92672">=</span> float(<span style="color:#e6db74">&#39;inf&#39;</span>)
</span></span><span style="display:flex;"><span>        best_info <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i, a <span style="color:#f92672">in</span> enumerate(coeffs):
</span></span><span style="display:flex;"><span>            val <span style="color:#f92672">=</span> a <span style="color:#f92672">*</span> factorial(i)
</span></span><span style="display:flex;"><span>            rounded <span style="color:#f92672">=</span> round(val)
</span></span><span style="display:flex;"><span>            error <span style="color:#f92672">=</span> abs(val <span style="color:#f92672">-</span> rounded)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> is_printable_ascii(rounded) <span style="color:#f92672">and</span> error <span style="color:#f92672">&lt;</span> best_error:
</span></span><span style="display:flex;"><span>                best_char <span style="color:#f92672">=</span> chr(rounded)
</span></span><span style="display:flex;"><span>                best_error <span style="color:#f92672">=</span> error
</span></span><span style="display:flex;"><span>                best_info <span style="color:#f92672">=</span> (i, a, val, rounded, error)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> best_char <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;?&#39;</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">[!] Could not determine char for </span><span style="color:#e6db74">{</span>fn<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> i, a <span style="color:#f92672">in</span> enumerate(coeffs):
</span></span><span style="display:flex;"><span>                val <span style="color:#f92672">=</span> a <span style="color:#f92672">*</span> factorial(i)
</span></span><span style="display:flex;"><span>                rounded <span style="color:#f92672">=</span> round(val)
</span></span><span style="display:flex;"><span>                error <span style="color:#f92672">=</span> abs(val <span style="color:#f92672">-</span> rounded)
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;  a</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74"> = </span><span style="color:#e6db74">{</span>a<span style="color:#e6db74">:</span><span style="color:#e6db74">.8f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, a</span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74"> * </span><span style="color:#e6db74">{</span>i<span style="color:#e6db74">}</span><span style="color:#e6db74">! = </span><span style="color:#e6db74">{</span>val<span style="color:#e6db74">:</span><span style="color:#e6db74">.2f</span><span style="color:#e6db74">}</span><span style="color:#e6db74">, round = </span><span style="color:#e6db74">{</span>rounded<span style="color:#e6db74">}</span><span style="color:#e6db74">, error = </span><span style="color:#e6db74">{</span>error<span style="color:#e6db74">:</span><span style="color:#e6db74">.2e</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            n, a, val, r, err <span style="color:#f92672">=</span> best_info
</span></span><span style="display:flex;"><span>        chars<span style="color:#f92672">.</span>append(best_char)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(chars))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    decode_flag()
</span></span></code></pre></div><p>There goes the flag: <strong>Blitz{C4lcu1us_G0eS_Brrrrrrrrr!!!}</strong></p>
<hr>
<p><img alt="Primeagen" loading="lazy" src="https://media1.tenor.com/m/hYU0XdvEzmAAAAAC/theprimeagen-primeagen.gif"></p>
<p>That&rsquo;s all for this blog, thank you for reading.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/ctf/">CTF</a></li>
      <li><a href="http://localhost:1313/tags/cryptography/">Cryptography</a></li>
      <li><a href="http://localhost:1313/tags/writeups/">Writeups</a></li>
      <li><a href="http://localhost:1313/tags/cyber-security/">Cyber Security</a></li>
      <li><a href="http://localhost:1313/tags/blitz-ctf/">Blitz CTF</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="http://localhost:1313/posts/worldwide-ctf-faulty-curve-challenge-writeup-cryptography/">
    <span class="title">« Prev</span>
    <br>
    <span>WorldWide CTF “Faulty Curve” Challenge Writeup (Cryptography)</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">Yacine&#39;s blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
